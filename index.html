<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rust Crafting Master</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@6.11.0/css/flag-icons.min.css"/>
    
    <style>
        :root {
            --bg-color: #1b1b1b;
            --panel-color: #2b2b2b;
            --accent-color: #cd412b;
            --btn-color: #5f8a2d;
            --btn-hover: #76aa3b;
            --text-color: #cecece;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            padding: 20px;
        }
        .container {
            background-color: var(--panel-color);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            max-width: 600px;
            width: 100%;
            position: relative;
        }
        
        /* Language Flags Styling */
        .lang-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-bottom: 10px;
        }
        .flag-btn {
            background: #141414;
            border: 2px solid #444;
            border-radius: 50%; /* Kulaté tlačítko */
            cursor: pointer;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
            overflow: hidden; /* Aby vlajka nepřečuhovala */
            padding: 0;
            filter: grayscale(100%);
        }
        .flag-btn span {
            font-size: 26px; /* Velikost vlajky uvnitř kolečka */
            line-height: 1em;
            display: block;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
        }

        .flag-btn:hover, .flag-btn.active {
            filter: grayscale(0%);
            border-color: var(--accent-color);
            transform: scale(1.1);
        }

        h1 { color: var(--accent-color); text-align: center; margin-bottom: 20px; margin-top: 0; text-transform: uppercase; letter-spacing: 1px;}
        label { display: block; margin-bottom: 8px; font-weight: bold; margin-top: 15px;}
        
        input, select {
            width: 100%;
            padding: 12px;
            background-color: #141414;
            border: 1px solid #444;
            color: white;
            border-radius: 4px;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        button.calc-btn {
            width: 100%;
            padding: 15px;
            background-color: var(--btn-color);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 25px;
            font-weight: bold;
            text-transform: uppercase;
            transition: 0.2s;
        }
        button.calc-btn:hover { background-color: var(--btn-hover); }
        
        .result-box {
            margin-top: 25px;
            padding: 20px;
            background-color: #141414;
            border-left: 5px solid var(--accent-color);
            display: none;
        }
        
        .item-image {
            display: block;
            margin: 0 auto 15px auto;
            max-width: 100px;
            height: auto;
        }

        .big-number { font-size: 1.5em; color: var(--accent-color); font-weight: bold; text-align: center; }
        .section-title { color: #888; text-transform: uppercase; font-size: 0.85em; margin-top: 20px; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 5px;}
        
        ul { list-style-type: none; padding: 0; }
        ul li { background: #222; margin-bottom: 5px; padding: 8px; border-radius: 4px; display: flex; justify-content: space-between; align-items: center;}
        .val { color: #fff; font-weight: bold; }
        
        .instruction {
            background-color: #2a2a35;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            border: 1px solid #444;
            line-height: 1.6;
        }
        .instruction span { color: #6db3f2; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="lang-buttons">
        <button class="flag-btn active" onclick="setLang('en')" id="btn-en" title="English"><span class="fi fi-us"></span></button>
        <button class="flag-btn" onclick="setLang('cs')" id="btn-cs" title="Čeština"><span class="fi fi-cz"></span></button>
        <button class="flag-btn" onclick="setLang('ru')" id="btn-ru" title="Русский"><span class="fi fi-ru"></span></button>
        <button class="flag-btn" onclick="setLang('zh')" id="btn-zh" title="中文"><span class="fi fi-cn"></span></button>
    </div>

    <h1>Rust Crafting Master</h1>
    
    <label for="itemType" id="t_selectItem">Select Item</label>
    <select id="itemType">
        </select>

    <label for="sulfur" id="t_enterSulfur">Sulfur Amount</label>
    <input type="number" id="sulfur" placeholder="50000">

    <button onclick="calculate()" id="t_calculateBtn" class="calc-btn">Calculate</button>

    <div id="result" class="result-box">
        <img id="resultImage" src="" alt="Item" class="item-image">
        
        <div style="text-align: center; margin-bottom: 20px;">
            <div id="t_youCanCraft">You can craft:</div>
            <div id="finalCount" class="big-number">0</div>
            <div id="itemNameDisplay" style="color:#aaa;"></div>
        </div>

        <div class="section-title" id="t_sulfurManagement">1. Sulfur Management</div>
        <div class="instruction">
            <span id="t_step1">Take</span> <span id="sulfurToGP">0</span> <span id="t_sulfurRaw">Sulfur</span>.<br>
            <span id="t_step2">Craft it into</span> <span id="gpCount">0</span> <span id="t_gp">Gunpowder</span>.
        </div>
        <div class="instruction" id="expInstructionBox">
            <span id="t_step3">Keep</span> <span id="sulfurToKeep">0</span> <span id="t_sulfurRaw2">Sulfur</span> <span id="t_inInventory">raw in inventory</span>.<br>
            <span id="t_step4">Use it to craft</span> <span id="expCount">0</span> <span id="expLabel">Explosives</span>.
        </div>

        <div class="section-title" id="t_otherMaterials">2. Other Materials Needed</div>
        <ul id="materialsList">
            </ul>
    </div>
</div>

<script>
    // --- TRANSLATIONS ---
    const translations = {
        en: {
            selectItem: "What to craft?",
            enterSulfur: "Total Sulfur Amount",
            calculateBtn: "Calculate Crafting",
            youCanCraft: "You can craft:",
            sulfurManagement: "1. Sulfur Management",
            otherMaterials: "2. Other Materials Needed",
            step1: "Take",
            step2: "Craft it into",
            step3: "Keep",
            step4: "Use it to craft",
            sulfurRaw: "Sulfur",
            gp: "Gunpowder",
            explosives: "Explosives",
            inInventory: "raw in inventory",
            leftover: "Leftover Sulfur",
            useForAmmo: "Use it directly in Ammo mixing",
            items: {
                rocket: "Rocket",
                c4: "Timed Explosive Charge",
                hv: "High Velocity Rocket",
                incen: "Incendiary Rocket",
                exp556: "Explosive 5.56 Ammo",
                charcoal: "Charcoal",
                frags: "Metal Fragments",
                fuel: "Low Grade Fuel",
                pipe: "Metal Pipe",
                tech: "Tech Trash",
                cloth: "Cloth"
            }
        },
        cs: {
            selectItem: "Co chceš vyrábět?",
            enterSulfur: "Množství sulfuru",
            calculateBtn: "Spočítat",
            youCanCraft: "Můžeš vyrobit:",
            sulfurManagement: "1. Manažment Sulfuru",
            otherMaterials: "2. Další suroviny",
            step1: "Vezmi",
            step2: "Vyrob z toho",
            step3: "Nech si",
            step4: "Použij na výrobu",
            sulfurRaw: "Sulfuru",
            gp: "Gunpowderu",
            explosives: "Explosives",
            inInventory: "v inventáři",
            leftover: "Zbytek sulfuru",
            useForAmmo: "Použij přímo při výrobě nábojů",
            items: {
                rocket: "Raketa",
                c4: "C4 (Timed Explosive)",
                hv: "HV Raketa",
                incen: "Zápalná Raketa (Incendiary)",
                exp556: "Explozivní munice 5.56",
                charcoal: "Charcoal (Uhlí)",
                frags: "Metal Fragments",
                fuel: "Low Grade Fuel",
                pipe: "Metal Pipe",
                tech: "Tech Trash",
                cloth: "Cloth (Látka)"
            }
        },
        ru: {
            selectItem: "Что крафтим?",
            enterSulfur: "Количество Серы",
            calculateBtn: "Рассчитать",
            youCanCraft: "Можно скрафтить:",
            sulfurManagement: "1. Управление серой",
            otherMaterials: "2. Требуемые ресурсы",
            step1: "Возьми",
            step2: "Скрафти",
            step3: "Оставь",
            step4: "Используй для",
            sulfurRaw: "Серы",
            gp: "Пороха",
            explosives: "Взрывчатки",
            inInventory: "в инвентаре",
            leftover: "Остаток",
            useForAmmo: "Используй для крафта патронов",
            items: {
                rocket: "Ракета",
                c4: "C4 (Взрывчатка)",
                hv: "HV Ракета",
                incen: "Зажигательная ракета",
                exp556: "Разрывные патроны",
                charcoal: "Уголь",
                frags: "Фрагменты металла",
                fuel: "Топлево (LGF)",
                pipe: "Труба",
                tech: "Микросхемы",
                cloth: "Ткань"
            }
        },
        zh: {
            selectItem: "你想制造什么？",
            enterSulfur: "硫磺总量",
            calculateBtn: "计算",
            youCanCraft: "你可以制造：",
            sulfurManagement: "1. 硫磺分配",
            otherMaterials: "2. 其他所需材料",
            step1: "取出",
            step2: "制作成",
            step3: "保留",
            step4: "用于制作",
            sulfurRaw: "硫磺",
            gp: "火药",
            explosives: "炸药",
            inInventory: "在背包中",
            leftover: "剩余硫磺",
            useForAmmo: "直接用于制作弹药",
            items: {
                rocket: "火箭",
                c4: "定时炸药",
                hv: "高速火箭",
                incen: "燃烧火箭",
                exp556: "爆炸弹药 ",
                charcoal: "木炭",
                frags: "金属碎片",
                fuel: "低级燃料",
                pipe: "金属管",
                tech: "科技零件",
                cloth: "布"
            }
        }
    };

    // --- DATA & LOGIC ---
    const recipes = {
        rocket: {
            id: "rocket",
            sulfurTotal: 1400,
            gpPerItem: 650, 
            explosivesPerItem: 10,
            rawSulfurToKeep: 100,
            imgUrl: "https://rustlabs.com/img/items180/ammo.rocket.basic.png",
            other: [
                {id: "charcoal", amount: 1950},
                {id: "frags", amount: 100},
                {id: "fuel", amount: 30},
                {id: "pipe", amount: 2}
            ]
        },
        incen: {
            id: "incen",
            sulfurTotal: 610,
            gpPerItem: 300,
            explosivesPerItem: 1,
            rawSulfurToKeep: 10,
            imgUrl: "https://rustlabs.com/img/items180/ammo.rocket.fire.png",
            other: [
                {id: "charcoal", amount: 900},
                {id: "frags", amount: 10},
                {id: "fuel", amount: 260},
                {id: "pipe", amount: 2}
            ]
        },
        c4: {
            id: "c4",
            sulfurTotal: 2200,
            gpPerItem: 1000,
            explosivesPerItem: 20,
            rawSulfurToKeep: 200,
            imgUrl: "https://rustlabs.com/img/items180/explosive.timed.png",
            other: [
                {id: "charcoal", amount: 3000},
                {id: "frags", amount: 200},
                {id: "fuel", amount: 60},
                {id: "tech", amount: 2},
                {id: "cloth", amount: 5}
            ]
        },
        hv: {
            id: "hv",
            sulfurTotal: 200,
            gpPerItem: 100,
            explosivesPerItem: 0,
            rawSulfurToKeep: 0,
            imgUrl: "https://rustlabs.com/img/items180/ammo.rocket.hv.png",
            other: [
                {id: "charcoal", amount: 300},
                {id: "pipe", amount: 1}
            ]
        },
        exp556: {
            id: "exp556",
            sulfurTotal: 50,
            gpPerItem: 20,
            explosivesPerItem: 0,
            rawSulfurToKeep: 10,
            imgUrl: "https://rustlabs.com/img/items180/ammo.rifle.explosive.png",
            other: [
                {id: "charcoal", amount: 60},
                {id: "frags", amount: 10}
            ]
        }
    };

    let currentLang = "en";

    function setLang(lang) {
        currentLang = lang;
        // Update active button state
        document.querySelectorAll('.flag-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById('btn-' + lang).classList.add('active');
        
        updateTexts();
    }

    function updateTexts() {
        const t = translations[currentLang];

        document.getElementById('t_selectItem').innerText = t.selectItem;
        document.getElementById('t_enterSulfur').innerText = t.enterSulfur;
        document.getElementById('t_calculateBtn').innerText = t.calculateBtn;
        document.getElementById('t_youCanCraft').innerText = t.youCanCraft;
        document.getElementById('t_sulfurManagement').innerText = t.sulfurManagement;
        document.getElementById('t_otherMaterials').innerText = t.otherMaterials;
        
        document.getElementById('t_step1').innerText = t.step1;
        document.getElementById('t_step2').innerText = t.step2;
        document.getElementById('t_step3').innerText = t.step3;
        
        document.getElementById('t_sulfurRaw').innerText = t.sulfurRaw;
        document.getElementById('t_sulfurRaw2').innerText = t.sulfurRaw;
        document.getElementById('t_gp').innerText = t.gp;
        document.getElementById('t_inInventory').innerText = t.inInventory;

        // Populate Select Options (keep selection if possible)
        const select = document.getElementById('itemType');
        const selectedValue = select.value;
        select.innerHTML = ""; // Clear existing
        
        for (const [key, value] of Object.entries(recipes)) {
            const opt = document.createElement('option');
            opt.value = key;
            opt.innerText = t.items[value.id];
            select.appendChild(opt);
        }
        
        if (selectedValue && recipes[selectedValue]) {
            select.value = selectedValue;
        }

        // Re-calculate if result is visible
        if(document.getElementById('result').style.display === 'block') {
            calculate();
        }
    }

    function calculate() {
        const sulfurInput = parseInt(document.getElementById('sulfur').value);
        const type = document.getElementById('itemType').value;
        const recipe = recipes[type];
        const t = translations[currentLang];

        if (isNaN(sulfurInput) || sulfurInput <= 0) {
            return;
        }

        const maxItems = Math.floor(sulfurInput / recipe.sulfurTotal);

        if (maxItems === 0) {
            alert(`Not enough Sulfur!`);
            return;
        }

        const totalGP = maxItems * recipe.gpPerItem;
        const sulfurForGP = totalGP * 2;
        const totalExp = maxItems * recipe.explosivesPerItem;
        const sulfurReserved = maxItems * recipe.rawSulfurToKeep;

        // Image
        document.getElementById('resultImage').src = recipe.imgUrl;

        // Numbers
        let countText = maxItems + " x " + t.items[recipe.id];
        if(recipe.id === 'exp556') {
             countText += ` (${maxItems * 2} bullets)`;
        }
        
        document.getElementById('finalCount').innerText = countText;
        
        const leftover = sulfurInput - (maxItems * recipe.sulfurTotal);
        document.getElementById('itemNameDisplay').innerText = `(${t.leftover}: ${leftover})`;

        document.getElementById('sulfurToGP').innerText = sulfurForGP.toLocaleString();
        document.getElementById('gpCount').innerText = totalGP.toLocaleString();

        const expBox = document.getElementById('expInstructionBox');
        const expLabel = document.getElementById('expLabel');
        const step4Label = document.getElementById('t_step4');

        if (recipe.rawSulfurToKeep > 0) {
            expBox.style.display = 'block';
            document.getElementById('sulfurToKeep').innerText = sulfurReserved.toLocaleString();
            
            if (recipe.explosivesPerItem > 0) {
                step4Label.innerText = t.step4;
                document.getElementById('expCount').innerText = totalExp.toLocaleString();
                expLabel.innerText = " " + t.explosives;
            } else {
                step4Label.innerText = t.useForAmmo;
                document.getElementById('expCount').innerText = "";
                expLabel.innerText = "";
            }
        } else {
            expBox.style.display = 'none';
        }

        const listEl = document.getElementById('materialsList');
        listEl.innerHTML = "";
        
        recipe.other.forEach(mat => {
            const totalNeeded = mat.amount * maxItems;
            const li = document.createElement('li');
            li.innerHTML = `<span>${t.items[mat.id]}</span> <span class="val">${totalNeeded.toLocaleString()}</span>`;
            listEl.appendChild(li);
        });

        document.getElementById('result').style.display = 'block';
    }

    // Initialize
    updateTexts();
</script>

</body>
</html>
